{
  "experiment_name": "real_economy_rotator_v19",
  "processor": "generic",
  "model_type": "experimental_v17",
  "use_revin": true,
  "bidirectional": true,
  "use_kan": true,
  "use_gpu": true,
  "use_directional_head": true,
  "train_years": 13,
  "val_years": 2,
  "test_years": 2,
  "batch_size": 64,
  "epochs": 150,
  "early_stopping_patience": 15,
  "hidden_size": 384,
  "n_heads": 8,
  "dropout": 0.3275931456658031,
  "lr": 0.00019127436202589324,
  "lstm_layers": 5,
  "trans_layers": 6,
  "n_experts": 12,
  "loss_type": "directional_focal",
  "dfl_alpha": 0.4773387055533217,
  "dfl_beta": 0.38966162871075816,
  "dfl_gamma": 0.37007397441804946,
  "focal_gamma": 1.7374169036193363,
  "asymmetric_penalty": 2.7861440099774013,
  "cls_weight": 0.5,
  "cls_threshold": 0.011885730082392017,
  "bear_weight": 1.9583807313798691,
  "seq_length": 60,
  "extra_tickers": [
    "TLT",
    "SHY",
    "XLE",
    "XLF"
  ],
  "feature_pipeline": [
    {
      "step": "log_return",
      "input": "underlying_close",
      "output": "log_ret",
      "lags": [
        3,
        5,
        10,
        20
      ]
    },
    {
      "step": "technical_indicator",
      "indicator": "rsi",
      "input": "underlying_close",
      "period": 7,
      "output": "rsi_7"
    },
    {
      "step": "technical_indicator",
      "indicator": "rsi",
      "input": "underlying_close",
      "period": 14,
      "output": "rsi_14"
    },
    {
      "step": "technical_indicator",
      "indicator": "atr",
      "period": 5,
      "output": "atr_5"
    },
    {
      "step": "technical_indicator",
      "indicator": "atr",
      "period": 20,
      "output": "atr_20"
    },
    {
      "step": "arithmetic",
      "formula": "atr_5 / (atr_20 + 1e-6)",
      "output": "atr_ratio"
    },
    {
      "step": "bollinger_position",
      "input": "underlying_close",
      "window": 20,
      "output": "bb_pos"
    },
    {
      "step": "volume_ratio",
      "input": "volume",
      "window": 20,
      "output": "vol_ratio"
    },
    {
      "step": "close_vs_ma",
      "input": "underlying_close",
      "window": 7,
      "output": "close_vs_ma7"
    },
    {
      "step": "roc",
      "input": "underlying_close",
      "period": 3,
      "output": "roc_3"
    },
    {
      "step": "roc",
      "input": "underlying_close",
      "period": 7,
      "output": "roc_7"
    },
    {
      "step": "lag_diff",
      "input": "tlt",
      "lag": 5,
      "pct_change": true,
      "output": "tlt_mom_5"
    },
    {
      "step": "arithmetic",
      "formula": "tlt / (shy + 1e-6)",
      "output": "yield_curve_proxy"
    },
    {
      "step": "lag_diff",
      "input": "xle",
      "lag": 5,
      "pct_change": true,
      "output": "xle_mom_5"
    },
    {
      "step": "lag_diff",
      "input": "xlf",
      "lag": 5,
      "pct_change": true,
      "output": "xlf_mom_5"
    },
    {
      "step": "normalize",
      "columns": [
        "us_treasury_10y",
        "vix",
        "rsi_7",
        "rsi_14",
        "atr_ratio",
        "bb_pos",
        "vol_ratio",
        "close_vs_ma7",
        "roc_3",
        "roc_7",
        "yield_curve_slope",
        "tlt_mom_5",
        "yield_curve_proxy",
        "xle_mom_5",
        "xlf_mom_5"
      ],
      "window": 60,
      "suffix": "_norm"
    }
  ],
  "dynamic_columns": [
    "log_ret",
    "log_ret_3",
    "log_ret_5",
    "log_ret_10",
    "log_ret_20",
    "rsi_7_norm",
    "rsi_14_norm",
    "atr_ratio_norm",
    "bb_pos_norm",
    "vol_ratio_norm",
    "close_vs_ma7_norm",
    "roc_3_norm",
    "roc_7_norm",
    "yield_curve_slope_norm",
    "tlt_mom_5_norm",
    "yield_curve_proxy_norm",
    "xle_mom_5_norm",
    "xlf_mom_5_norm",
    "us_treasury_10y_norm",
    "vix_norm"
  ],
  "static_columns": [
    "strike_distance",
    "dte_normalized",
    "is_call",
    "moneyness"
  ],
  "targets": [
    {
      "name": "target_1",
      "input": "underlying_close",
      "horizon": 7,
      "type": "log_future_return"
    },
    {
      "name": "target_2",
      "input": "underlying_close",
      "horizon": 21,
      "type": "log_future_return"
    }
  ],
  "optuna": {
    "n_trials": 30,
    "search_space": {
      "hidden_size": {
        "type": "categorical",
        "choices": [
          256,
          384,
          512,
          768
        ]
      },
      "lstm_layers": {
        "type": "int",
        "low": 4,
        "high": 10
      },
      "trans_layers": {
        "type": "int",
        "low": 4,
        "high": 8
      },
      "n_experts": {
        "type": "categorical",
        "choices": [
          4,
          6,
          8,
          12
        ]
      },
      "dropout": {
        "type": "float",
        "low": 0.1,
        "high": 0.35
      },
      "lr": {
        "type": "loguniform",
        "low": 1e-05,
        "high": 0.0005
      },
      "batch_size": {
        "type": "categorical",
        "choices": [
          64,
          128,
          256
        ]
      },
      "seq_length": {
        "type": "categorical",
        "choices": [
          30,
          45,
          60
        ]
      },
      "cls_threshold": {
        "type": "float",
        "low": 0.005,
        "high": 0.02
      },
      "dfl_alpha": {
        "type": "float",
        "low": 0.2,
        "high": 0.5
      },
      "dfl_beta": {
        "type": "float",
        "low": 0.2,
        "high": 0.5
      },
      "dfl_gamma": {
        "type": "float",
        "low": 0.1,
        "high": 0.4
      },
      "bear_weight": {
        "type": "float",
        "low": 1.5,
        "high": 4.0
      },
      "asymmetric_penalty": {
        "type": "float",
        "low": 2.0,
        "high": 5.0
      },
      "focal_gamma": {
        "type": "float",
        "low": 1.0,
        "high": 3.0
      }
    }
  },
  "input_dim": 20,
  "static_dim": 4
}